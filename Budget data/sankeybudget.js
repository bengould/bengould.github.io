var budget_data = {"General Fund: Revenues": {"Real Property Tax": {"FY 2013": "40210337", "FY 2014": "42181381", "FY 2015": "44352255", "FY 2016": "46351907", "FY 2017": "48126587", "FY 2018": "50018636", "FY 2019": "50768165"}, "Property Transfer Tax": {"FY 2013": "11663871", "FY 2014": "14017607", "FY 2015": "11000000", "FY 2016": "10500000", "FY 2017": "10500000", "FY 2018": "12500000", "FY 2019": "12500000"}, "Unsecured Property": {"FY 2013": "2298523", "FY 2014": "2496321", "FY 2015": "2498523", "FY 2016": "2797777", "FY 2017": "2907777", "FY 2018": "2767684", "FY 2019": "2809200"}, "Sales Tax": {"FY 2013": "15708699", "FY 2014": "16500324", "FY 2015": "16365826", "FY 2016": "18116161", "FY 2017": "17210353", "FY 2018": "18000000", "FY 2019": "18522000"}, "Business License": {"FY 2013": "15266648", "FY 2014": "15370377", "FY 2015": "16253126", "FY 2016": "16762680", "FY 2017": "17097934", "FY 2018": "18451191", "FY 2019": "18727959"}, "Hotel Tax": {"FY 2013": "5562168", "FY 2014": "6169161", "FY 2015": "5957082", "FY 2016": "6561872", "FY 2017": "6693110", "FY 2018": "7969633", "FY 2019": "8089178"}, "Utility Users Tax": {"FY 2013": "14350002", "FY 2014": "14321714", "FY 2015": "14629742", "FY 2016": "14447392", "FY 2017": "14194436", "FY 2018": "14282375", "FY 2019": "14496610"}, "Auto. In-Lieu": {"FY 2013": "8738116", "FY 2014": "9277702", "FY 2015": "9671582", "FY 2016": "10167383", "FY 2017": "10566772", "FY 2018": "10320402", "FY 2019": "10475208"}, "Parking Fines": {"FY 2013": "8013537", "FY 2014": "6850399", "FY 2015": "7000000", "FY 2016": "7322500", "FY 2017": "7395725", "FY 2018": "6503322", "FY 2019": "6600871"}, "Moving Violations": {"FY 2013": "248798", "FY 2014": "670363", "FY 2015": "200000", "FY 2016": "234600", "FY 2017": "239292", "FY 2018": "239770", "FY 2019": "243367"}, "Interest": {"FY 2013": "3320372", "FY 2014": "2465334", "FY 2015": "2600000", "FY 2016": "2470000", "FY 2017": "2346500", "FY 2018": "2211000", "FY 2019": "2244165"}, "Service Fees": {"FY 2013": "8170473", "FY 2014": "8463613", "FY 2015": "8246837", "FY 2016": "7991504", "FY 2017": "8143343", "FY 2018": "6779035", "FY 2019": "6897838"}, "SUB-TOTAL": {"FY 2013": "133551544", "FY 2014": "138784296", "FY 2015": "138774973", "FY 2016": "143723776", "FY 2017": "145421829", "FY 2018": "150043048", "FY 2019": "152374561"}, "Other Revenues": {"FY 2013": "16711514", "FY 2014": "16431847", "FY 2015": "15606528", "FY 2016": "15731199", "FY 2017": "15970747", "FY 2018": "11106877", "FY 2019": "11114390"}, "TOTAL": {"FY 2013": "150263058", "FY 2014": "155216143", "FY 2015": "154381501", "FY 2016": "159454975", "FY 2017": "161392576", "FY 2018": "161149925", "FY 2019": "163488951"}}, "General Fund: Expenditures": {"Mayor  & Council": {"FY 2013": "1706149", "FY 2014": "1733917", "FY 2015": "1768200", "FY 2016": "1792456", "FY 2017": "1810354", "FY 2018": "2028441", "FY 2019": "2074738"}, "Auditor": {"FY 2013": "1924656", "FY 2014": "1925222", "FY 2015": "2052561", "FY 2016": "2116882", "FY 2017": "2147259", "FY 2018": "2261463", "FY 2019": "2304413"}, "Police Review Commission": {"FY 2013": "488526", "FY 2014": "484845", "FY 2015": "549881", "FY 2016": "562803", "FY 2017": "570417", "FY 2018": "722180", "FY 2019": "738060"}, "City Manager": {"FY 2013": "4414612", "FY 2014": "4614527", "FY 2015": "4796940", "FY 2016": "4833991", "FY 2017": "4901792", "FY 2018": "5883194", "FY 2019": "6106514"}, "Office of Economic Development": {"FY 2013": "1832488", "FY 2014": "1875736", "FY 2015": "2027532", "FY 2016": "2039208", "FY 2017": "2063458", "FY 2018": "2691403", "FY 2019": "2560121"}, "Information Technology": {"FY 2013": "5203863", "FY 2014": "4743945", "FY 2015": "5260048", "FY 2016": "5232676", "FY 2017": "5288686", "FY 2018": "5770103", "FY 2019": "6232527"}, "City Attorney": {"FY 2013": "2212760", "FY 2014": "2220327", "FY 2015": "2300900", "FY 2016": "2225084", "FY 2017": "2255910", "FY 2018": "2398356", "FY 2019": "2453702"}, "City Clerk": {"FY 2013": "1963304", "FY 2014": "1504701", "FY 2015": "1897904", "FY 2016": "1982311", "FY 2017": "2004248", "FY 2018": "2059366", "FY 2019": "2097256"}, "Finance": {"FY 2013": "5262578", "FY 2014": "5255871", "FY 2015": "5536002", "FY 2016": "5559396", "FY 2017": "5637409", "FY 2018": "5756160", "FY 2019": "5741525"}, "Human Resources": {"FY 2013": "1734270", "FY 2014": "1798549", "FY 2015": "1890079", "FY 2016": "1847317", "FY 2017": "1873393", "FY 2018": "1977674", "FY 2019": "2024979"}, "Health & Housing  & Community Services": {"FY 2013": "11345141", "FY 2014": "11773139", "FY 2015": "12211374", "FY 2016": "12387323", "FY 2017": "12528058", "FY 2018": "15049190", "FY 2019": "14946689"}, "Police": {"FY 2013": "55030664", "FY 2014": "55836689", "FY 2015": "55820901", "FY 2016": "57170615", "FY 2017": "58368718", "FY 2018": "61378677", "FY 2019": "63187683"}, "Fire": {"FY 2013": "25405453", "FY 2014": "26422372", "FY 2015": "27718065", "FY 2016": "28315624", "FY 2017": "28692307", "FY 2018": "30984535", "FY 2019": "31985365"}, "Public Works": {"FY 2013": "2333305", "FY 2014": "2275051", "FY 2015": "2600255", "FY 2016": "2667233", "FY 2017": "2696864", "FY 2018": "3276300", "FY 2019": "3317370"}, "Parks & Recreation  & Waterfront": {"FY 2013": "5155636", "FY 2014": "5259661", "FY 2015": "5562004", "FY 2016": "5574104", "FY 2017": "5614605", "FY 2018": "5689002", "FY 2019": "5741567"}, "Planning": {"FY 2013": "1513689", "FY 2014": "1629124", "FY 2015": "1687798", "FY 2016": "1683361", "FY 2017": "1707729", "FY 2018": "1923055", "FY 2019": "1939915"}, "Community Agencies": {"FY 2013": "4370342", "FY 2014": "4290107", "FY 2015": "4535365", "FY 2016": "4762302", "FY 2017": "4762302", "FY 2018": "6634869", "FY 2019": "6595869"}, "Non-Departmental": {"FY 2013": "13889312", "FY 2014": "19469349", "FY 2015": "16165675", "FY 2016": "18488690", "FY 2017": "18466873", "FY 2018": "16407834", "FY 2019": "15265959"}, "TOTAL": {"FY 2013": "145786748", "FY 2014": "153113132", "FY 2015": "154381484", "FY 2016": "159241376", "FY 2017": "161390382", "FY 2018": "172891802", "FY 2019": "175314252"}}, "All Fund: Expenditures": {"Mayor  & Council": {"FY 2013": "1706149", "FY 2014": "1733917", "FY 2015": "1768200", "FY 2016": "1792456", "FY 2017": "1810354", "FY 2018": "2028441", "FY 2019": "2074738"}, "Auditor": {"FY 2013": "2044256", "FY 2014": "2065354", "FY 2015": "2182588", "FY 2016": "2270374", "FY 2017": "2303519", "FY 2018": "2424263", "FY 2019": "2470998"}, "Police Review Commission": {"FY 2013": "488526", "FY 2014": "484845", "FY 2015": "549881", "FY 2016": "562803", "FY 2017": "570417", "FY 2018": "722180", "FY 2019": "738060"}, "City Manager": {"FY 2013": "4692692", "FY 2014": "4887010", "FY 2015": "5248901", "FY 2016": "5324144", "FY 2017": "5396740", "FY 2018": "6637466", "FY 2019": "6867862"}, "Office of Economic Development": {"FY 2013": "3710268", "FY 2014": "3243496", "FY 2015": "4255394", "FY 2016": "4325946", "FY 2017": "4365179", "FY 2018": "5626805", "FY 2019": "5501089"}, "Information Technology": {"FY 2013": "8975620", "FY 2014": "8127798", "FY 2015": "8713473", "FY 2016": "8744066", "FY 2017": "8831302", "FY 2018": "16291888", "FY 2019": "17243481"}, "City Attorney": {"FY 2013": "3442297", "FY 2014": "3916746", "FY 2015": "4020533", "FY 2016": "4001225", "FY 2017": "4040002", "FY 2018": "4343771", "FY 2019": "4418951"}, "City Clerk": {"FY 2013": "1963304", "FY 2014": "1504701", "FY 2015": "1897904", "FY 2016": "1982311", "FY 2017": "2004248", "FY 2018": "2059366", "FY 2019": "2097256"}, "Finance": {"FY 2013": "6920204", "FY 2014": "6857845", "FY 2015": "7414589", "FY 2016": "7446289", "FY 2017": "7545035", "FY 2018": "7727093", "FY 2019": "7743231"}, "Human Resources": {"FY 2013": "2812261", "FY 2014": "2997178", "FY 2015": "3223497", "FY 2016": "3248181", "FY 2017": "3296954", "FY 2018": "3810616", "FY 2019": "3900907"}, "Health & Housing  & Community Services": {"FY 2013": "34077594", "FY 2014": "34729446", "FY 2015": "37701665", "FY 2016": "41341703", "FY 2017": "40108885", "FY 2018": "47355255", "FY 2019": "48602035"}, "Police": {"FY 2013": "57748694", "FY 2014": "59700592", "FY 2015": "60434204", "FY 2016": "62157537", "FY 2017": "63420717", "FY 2018": "66747004", "FY 2019": "68665330"}, "Fire": {"FY 2013": "31244878", "FY 2014": "32273589", "FY 2015": "34774493", "FY 2016": "35843030", "FY 2017": "36273849", "FY 2018": "39091308", "FY 2019": "40213292"}, "Public Works": {"FY 2013": "92344987", "FY 2014": "89659793", "FY 2015": "95242530", "FY 2016": "100209458", "FY 2017": "96572712", "FY 2018": "151198065", "FY 2019": "115099741"}, "Parks & Recreation  & Waterfront": {"FY 2013": "24093527", "FY 2014": "23678863", "FY 2015": "23524395", "FY 2016": "25139664", "FY 2017": "24838563", "FY 2018": "28271481", "FY 2019": "26964125"}, "Planning": {"FY 2013": "11175016", "FY 2014": "12480485", "FY 2015": "13105140", "FY 2016": "14441058", "FY 2017": "14628211", "FY 2018": "18201442", "FY 2019": "18391816"}, "Library": {"FY 2013": "23743956", "FY 2014": "20326538", "FY 2015": "19094157", "FY 2016": "18908184", "FY 2017": "17577785", "FY 2018": "20990466", "FY 2019": "19588394"}, "Rent Board": {"FY 2013": "3985087", "FY 2014": "3826758", "FY 2015": "4245000", "FY 2016": "4476410", "FY 2017": "4528273", "FY 2018": "5525740", "FY 2019": "5525740"}, "Non-Departmental": {"FY 2013": "55714388", "FY 2014": "49308061", "FY 2015": "48305192", "FY 2016": "50923829", "FY 2017": "50176410", "FY 2018": "47343920", "FY 2019": "45508051"}, "Subtotal": {"FY 2013": "370883704", "FY 2014": "361803015", "FY 2015": "375701736", "FY 2016": "393138668", "FY 2017": "388289155", "FY 2018": "476396570", "FY 2019": "441615097"}, "Berkeley Housing Authority": {"FY 2013": "138374", "FY 2014": "25326", "FY 2015": "-", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Less: Dual Appropriations": {"FY 2013": "-57759765", "FY 2014": "-54340815", "FY 2015": "-52331726", "FY 2016": "-55258672", "FY 2017": "-54317462", "FY 2018": "-25589992", "FY 2019": "-25157694"}, "NET EXPENDITURES": {"FY 2013": "313262313", "FY 2014": "307487526", "FY 2015": "323370010", "FY 2016": "337879996", "FY 2017": "333971693", "FY 2018": "450806578", "FY 2019": "416457403"}}, "Restricted Fund: Revenues": {"Special Revenue Funds": {"Emergency Disabled Services": {"FY 2013": "984051", "FY 2014": "1032227", "FY 2015": "1052122", "FY 2016": "1070929", "FY 2017": "1092347", "FY 2018": "1209625", "FY 2019": "1233817"}, "Paramedic Assessment/Tax": {"FY 2013": "3110933", "FY 2014": "3226626", "FY 2015": "2844356", "FY 2016": "3050030", "FY 2017": "3191390", "FY 2018": "3417084", "FY 2019": "3475415"}, "Parks Tax": {"FY 2013": "9542084", "FY 2014": "9762684", "FY 2015": "9948439", "FY 2016": "11826449", "FY 2017": "12027328", "FY 2018": "12816390", "FY 2019": "13081657"}, "Downtown Berkeley Prop  & Improv. District": {"FY 2013": "969769", "FY 2014": "947947", "FY 2015": "1005000", "FY 2016": "1005000", "FY 2017": "1005000", "FY 2018": "1250000", "FY 2019": "1250000"}, "Measure GG - Fire Prep Tax": {"FY 2013": "3917791", "FY 2014": "4130013", "FY 2015": "4186198", "FY 2016": "4256305", "FY 2017": "4341432", "FY 2018": "4812892", "FY 2019": "4909150"}, "Street Light Assess District": {"FY 2013": "2052466", "FY 2014": "2065845", "FY 2015": "2023244", "FY 2016": "1866961", "FY 2017": "1866961", "FY 2018": "1352432", "FY 2019": "1410489"}, "Solano Avenue Business Imp. District": {"FY 2013": "52888", "FY 2014": "28164", "FY 2015": "35000", "FY 2016": "35000", "FY 2017": "35000", "FY 2018": "35000", "FY 2019": "35000"}, "Downtown Business Imp. District": {"FY 2013": "4613", "FY 2014": "10", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Telegraph Bus Pro Imp District": {"FY 2013": "226933", "FY 2014": "226450", "FY 2015": "263000", "FY 2016": "263000", "FY 2017": "263000", "FY 2018": "489000", "FY 2019": "489000"}, "N. Shattuck Bus. Imp. Dist.": {"FY 2013": "165672", "FY 2014": "164558", "FY 2015": "168550", "FY 2016": "168550", "FY 2017": "168550", "FY 2018": "174011", "FY 2019": "174011"}, "Berkeley Tourism BID": {"FY 2013": "0", "FY 2014": "488864", "FY 2015": "496424", "FY 2016": "546823", "FY 2017": "557759", "FY 2018": "664136", "FY 2019": "674098"}, "Elmwood BID": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "30000", "FY 2016": "30000", "FY 2017": "30000", "FY 2018": "30000", "FY 2019": "30000"}, "Subtotal": {"FY 2013": "21027200", "FY 2014": "22073388", "FY 2015": "22052333", "FY 2016": "24119047", "FY 2017": "24578767", "FY 2018": "26250570", "FY 2019": "26762637"}}, "Enterprise Funds": {"Refuse": {"FY 2013": "33861186", "FY 2014": "34101574", "FY 2015": "36673523", "FY 2016": "37600783", "FY 2017": "37710238", "FY 2018": "40453300", "FY 2019": "41242753"}, "Marina Operation": {"FY 2013": "5230735", "FY 2014": "5478724", "FY 2015": "5558716", "FY 2016": "5311066", "FY 2017": "5311066", "FY 2018": "6245459", "FY 2019": "6270459"}, "Sewer": {"FY 2013": "13315067", "FY 2014": "13588024", "FY 2015": "12801227", "FY 2016": "12801227", "FY 2017": "12801227", "FY 2018": "21384982", "FY 2019": "22827768"}, "Clean Storm Water": {"FY 2013": "2467033", "FY 2014": "2316216", "FY 2015": "2365140", "FY 2016": "2502740", "FY 2017": "2510569", "FY 2018": "2388633", "FY 2019": "2369937"}, "Private Sewer Lateral": {"FY 2013": "577473", "FY 2014": "245868", "FY 2015": "240501", "FY 2016": "240501", "FY 2017": "240501", "FY 2018": "240501", "FY 2019": "240501"}, "Permit Service Center": {"FY 2013": "9249750", "FY 2014": "14087031", "FY 2015": "13552248", "FY 2016": "12238260", "FY 2017": "12544854", "FY 2018": "14528343", "FY 2019": "15003859"}, "Off Street Parking": {"FY 2013": "3781582", "FY 2014": "3858118", "FY 2015": "3743972", "FY 2016": "4204428", "FY 2017": "3504428", "FY 2018": "3496428", "FY 2019": "3496428"}, "Parking Meter": {"FY 2013": "6496735", "FY 2014": "8052253", "FY 2015": "6861311", "FY 2016": "9191713", "FY 2017": "9191713", "FY 2018": "9191713", "FY 2019": "9191713"}, "Unified Program - Toxics": {"FY 2013": "835264", "FY 2014": "792597", "FY 2015": "864531", "FY 2016": "851868", "FY 2017": "851868", "FY 2018": "792500", "FY 2019": "780500"}, "Building Management - 1947 Center St.": {"FY 2013": "2632711", "FY 2014": "2237128", "FY 2015": "2193961", "FY 2016": "2086780", "FY 2017": "2111455", "FY 2018": "3043752", "FY 2019": "3056813"}, "Subtotal": {"FY 2013": "78447536", "FY 2014": "84757533", "FY 2015": "84855130", "FY 2016": "87029366", "FY 2017": "86777919", "FY 2018": "101765611", "FY 2019": "104480731"}}, "Gas / Sales Tax Street Improvement Funds": {"FY 2013": "7360154", "FY 2014": "6713733", "FY 2015": "6161504", "FY 2016": "6042504", "FY 2017": "6042504", "FY 2018": "9197989", "FY 2019": "9376698"}, "Bond Funds": {"Measure FF - Branch Libraries": {"FY 2013": "17486", "FY 2014": "2639", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Measure G Bond Capital Improvements": {"FY 2013": "3253", "FY 2014": "1032", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Measure M - GO St  & Wtr Imps": {"FY 2013": "0", "FY 2014": "14975000", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Measure S Bond Capital Improvements": {"FY 2013": "952", "FY 2014": "292", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "BJPFA Lease Revenue Bonds": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "103336", "FY 2016": "103336", "FY 2017": "103336", "FY 2018": "103336", "FY 2019": "103336"}, "00 Mello-Roos - Fire Equipment": {"FY 2013": "100002", "FY 2014": "100000", "FY 2015": "100000", "FY 2016": "100000", "FY 2017": "100000", "FY 2018": "100000", "FY 2019": "100000"}, "Meas I - Animal Shelter": {"FY 2013": "13", "FY 2014": "4", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Subtotal": {"FY 2013": "121706", "FY 2014": "15078967", "FY 2015": "203336", "FY 2016": "203336", "FY 2017": "203336", "FY 2018": "203336", "FY 2019": "203336"}}, "Debt Service Funds": {"Debt Service Fund": {"FY 2013": "473295", "FY 2014": "473287", "FY 2015": "376750", "FY 2016": "335750", "FY 2017": "296000", "FY 2018": "262500", "FY 2019": "-"}, "09 Measure FF Library Debt Service": {"FY 2013": "1654837", "FY 2014": "1752087", "FY 2015": "1604969", "FY 2016": "1604969", "FY 2017": "1604969", "FY 2018": "1604969", "FY 2019": "1604969"}, "99 Lease Re Bds BJPFA $9M": {"FY 2013": "5829505", "FY 2014": "456963", "FY 2015": "500317", "FY 2016": "500645", "FY 2017": "499333", "FY 2018": "499942", "FY 2019": "498935"}, "SPL Tax Bds CFD#1 ML-ROOS": {"FY 2013": "992638", "FY 2014": "991639", "FY 2015": "0", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "2002 G.O. Refunding Bonds": {"FY 2013": "1505385", "FY 2014": "1650360", "FY 2015": "1463321", "FY 2016": "1463321", "FY 2017": "1463321", "FY 2018": "1463321", "FY 2019": "1463321"}, "Other Debt Service": {"FY 2013": "3973698", "FY 2014": "5321667", "FY 2015": "4283772", "FY 2016": "4274566", "FY 2017": "4280141", "FY 2018": "4275466", "FY 2019": "4275416"}, "Subtotal": {"FY 2013": "14429358", "FY 2014": "10646003", "FY 2015": "8229129", "FY 2016": "8179251", "FY 2017": "8143764", "FY 2018": "8106198", "FY 2019": "7842641"}}, "Grant Funds": {"Federal Grants": {"FY 2013": "7320500", "FY 2014": "8012853", "FY 2015": "7274894", "FY 2016": "7559973", "FY 2017": "7559973", "FY 2018": "9810018", "FY 2019": "9810018"}, "State / County Grants": {"FY 2013": "20919526", "FY 2014": "22821757", "FY 2015": "18303336", "FY 2016": "19965975", "FY 2017": "19859520", "FY 2018": "19257523", "FY 2019": "19507523"}, "Other Grants": {"FY 2013": "580696", "FY 2014": "255002", "FY 2015": "207762", "FY 2016": "330962", "FY 2017": "330962", "FY 2018": "263447", "FY 2019": "263447"}, "Subtotal": {"FY 2013": "28820722", "FY 2014": "31089612", "FY 2015": "25785992", "FY 2016": "27856910", "FY 2017": "27750455", "FY 2018": "29330988", "FY 2019": "29580988"}}, "Internal Service Funds": {"Employee Training Fund": {"FY 2013": "500000", "FY 2014": "500000", "FY 2015": "500000", "FY 2016": "500000", "FY 2017": "500000", "FY 2018": "750000", "FY 2019": "750000"}, "Equipment Replacement": {"FY 2013": "4472629", "FY 2014": "3560595", "FY 2015": "3743406", "FY 2016": "4023406", "FY 2017": "4023406", "FY 2018": "4163406", "FY 2019": "4163406"}, "Eqipment Maintenance": {"FY 2013": "7474062", "FY 2014": "6910069", "FY 2015": "6461013", "FY 2016": "6461013", "FY 2017": "6461013", "FY 2018": "6461013", "FY 2019": "6461013"}, "Building Maintenance Fund": {"FY 2013": "3616367", "FY 2014": "3573407", "FY 2015": "3588738", "FY 2016": "3588738", "FY 2017": "3588738", "FY 2018": "3588738", "FY 2019": "3588738"}, "Warehouse": {"FY 2013": "325824", "FY 2014": "327822", "FY 2015": "225000", "FY 2016": "225000", "FY 2017": "225000", "FY 2018": "225000", "FY 2019": "225000"}, "Computer  & Server Replacement": {"FY 2013": "380826", "FY 2014": "384216", "FY 2015": "382998", "FY 2016": "382998", "FY 2017": "382998", "FY 2018": "382998", "FY 2019": "382998"}, "Workers Compensation": {"FY 2013": "7967786", "FY 2014": "8226975", "FY 2015": "8316328", "FY 2016": "9199194", "FY 2017": "9201683", "FY 2018": "9569988", "FY 2019": "9681972"}, "Subtotal": {"FY 2013": "24737494", "FY 2014": "23483084", "FY 2015": "23217483", "FY 2016": "24380349", "FY 2017": "24382838", "FY 2018": "25141143", "FY 2019": "25253127"}}, "Other Funds": {"Capital Improvement Fund": {"FY 2013": "5305154", "FY 2014": "8222193", "FY 2015": "7731607", "FY 2016": "5501269", "FY 2017": "5501269", "FY 2018": "5348269", "FY 2019": "5348269"}, "Public Liability": {"FY 2013": "1752987", "FY 2014": "1695888", "FY 2015": "1695888", "FY 2016": "1695888", "FY 2017": "1695888", "FY 2018": "695000", "FY 2019": "393623"}, "Library": {"FY 2013": "15488692", "FY 2014": "16236039", "FY 2015": "16631412", "FY 2016": "16904288", "FY 2017": "17236634", "FY 2018": "19020937", "FY 2019": "19369671"}, "Rent Board": {"FY 2013": "3911005", "FY 2014": "3899835", "FY 2015": "3900000", "FY 2016": "3900000", "FY 2017": "3900000", "FY 2018": "5500000", "FY 2019": "5500000"}, "Successor Agency": {"FY 2013": "2746208", "FY 2014": "2868432", "FY 2015": "3172884", "FY 2016": "1222988", "FY 2017": "1222988", "FY 2018": "486367", "FY 2019": "486367"}, "Playground Camp": {"FY 2013": "2072410", "FY 2014": "6352799", "FY 2015": "1000832", "FY 2016": "1000832", "FY 2017": "1000832", "FY 2018": "1000832", "FY 2019": "1000832"}, "Hlth State Aid Realign Trust": {"FY 2013": "3583097", "FY 2014": "4081366", "FY 2015": "3603018", "FY 2016": "3703018", "FY 2017": "3703018", "FY 2018": "3703018", "FY 2019": "3703018"}, "Other Funds": {"FY 2013": "5254050", "FY 2014": "6405333", "FY 2015": "4026059", "FY 2016": "4110712", "FY 2017": "4176884", "FY 2018": "4183079", "FY 2019": "4031843"}, "Subtotal": {"FY 2013": "40113603", "FY 2014": "49761885", "FY 2015": "41761700", "FY 2016": "38038995", "FY 2017": "38437513", "FY 2018": "39937502", "FY 2019": "39833623"}}, "Revenue Totals": {"FY 2013": "215057773", "FY 2014": "243604205", "FY 2015": "212266607", "FY 2016": "215849758", "FY 2017": "216317096", "FY 2018": "230735348", "FY 2019": "233957083"}}, "Restricted Funds: Expenditures": {"Mayor  & Council": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "0", "FY 2016": "0", "FY 2017": "0", "FY 2018": "0", "FY 2019": "0"}, "Auditor": {"FY 2013": "119600", "FY 2014": "140132", "FY 2015": "130027", "FY 2016": "153492", "FY 2017": "156260", "FY 2018": "162800", "FY 2019": "166585"}, "Police Review Commission": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "0", "FY 2016": "0", "FY 2017": "0", "FY 2018": "0", "FY 2019": "0"}, "City Manager": {"FY 2013": "278080", "FY 2014": "272483", "FY 2015": "451961", "FY 2016": "490153", "FY 2017": "494948", "FY 2018": "754272", "FY 2019": "761348"}, "Office of Economic Development": {"FY 2013": "1877780", "FY 2014": "1367760", "FY 2015": "2227862", "FY 2016": "2286738", "FY 2017": "2301721", "FY 2018": "2935402", "FY 2019": "2940968"}, "Information Technology": {"FY 2013": "3771757", "FY 2014": "3383853", "FY 2015": "3453425", "FY 2016": "3511390", "FY 2017": "3542616", "FY 2018": "10521785", "FY 2019": "11010954"}, "City Attorney": {"FY 2013": "1229537", "FY 2014": "1696419", "FY 2015": "1719633", "FY 2016": "1776141", "FY 2017": "1784092", "FY 2018": "1945415", "FY 2019": "1965249"}, "City Clerk": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "0", "FY 2016": "0", "FY 2017": "0", "FY 2018": "0", "FY 2019": "0"}, "Finance": {"FY 2013": "1657626", "FY 2014": "1601974", "FY 2015": "1878587", "FY 2016": "1886893", "FY 2017": "1907626", "FY 2018": "1970933", "FY 2019": "2001706"}, "Human Resources": {"FY 2013": "1077991", "FY 2014": "1198629", "FY 2015": "1333418", "FY 2016": "1400864", "FY 2017": "1423561", "FY 2018": "1832942", "FY 2019": "1875928"}, "Health & Housing  & Community Services": {"FY 2013": "22732453", "FY 2014": "22956307", "FY 2015": "25490291", "FY 2016": "28954380", "FY 2017": "27580827", "FY 2018": "32306065", "FY 2019": "33655346"}, "Police": {"FY 2013": "2718030", "FY 2014": "3863903", "FY 2015": "4613303", "FY 2016": "4986922", "FY 2017": "5051999", "FY 2018": "5368327", "FY 2019": "5477647"}, "Fire": {"FY 2013": "5839425", "FY 2014": "5851217", "FY 2015": "7056428", "FY 2016": "7527406", "FY 2017": "7581542", "FY 2018": "8106773", "FY 2019": "8227927"}, "Public Works": {"FY 2013": "90011682", "FY 2014": "87384742", "FY 2015": "92642275", "FY 2016": "97542225", "FY 2017": "93875848", "FY 2018": "147921765", "FY 2019": "114782371"}, "Parks & Recreation  & Waterfront": {"FY 2013": "18937891", "FY 2014": "18419202", "FY 2015": "17962391", "FY 2016": "19565560", "FY 2017": "19223958", "FY 2018": "22882479", "FY 2019": "21222558"}, "Planning": {"FY 2013": "9661327", "FY 2014": "10851361", "FY 2015": "11417342", "FY 2016": "12757697", "FY 2017": "12920482", "FY 2018": "16278387", "FY 2019": "16451901"}, "Library": {"FY 2013": "23743956", "FY 2014": "20326538", "FY 2015": "19094157", "FY 2016": "18908184", "FY 2017": "17577785", "FY 2018": "831450", "FY 2019": "282561"}, "Rent Board": {"FY 2013": "3985087", "FY 2014": "3826758", "FY 2015": "4245000", "FY 2016": "4476410", "FY 2017": "4528273", "FY 2018": "5525740", "FY 2019": "5525740"}, "Community Agencies": {"FY 2013": "0", "FY 2014": "0", "FY 2015": "0", "FY 2016": "0", "FY 2017": "0", "FY 2018": "0", "FY 2019": "0"}, "Non-Departmental": {"FY 2013": "41825076", "FY 2014": "29838712", "FY 2015": "32139517", "FY 2016": "32435139", "FY 2017": "31709537", "FY 2018": "24301217", "FY 2019": "23646223"}, "Subtotal": {"FY 2013": "229467298", "FY 2014": "212979990", "FY 2015": "225855617", "FY 2016": "238659594", "FY 2017": "231661075", "FY 2018": "283645752", "FY 2019": "249995012"}, "Berkeley Housing Authority": {"FY 2013": "138374", "FY 2014": "25326", "FY 2015": "-", "FY 2016": "-", "FY 2017": "-", "FY 2018": "-", "FY 2019": "-"}, "Less: Dual Appropriations": {"FY 2013": "-", "FY 2014": "-", "FY 2015": "-52331726", "FY 2016": "-55258672", "FY 2017": "-54317462", "FY 2018": "-25589992", "FY 2019": "-25157694"}, "NET EXPENDITURES": {"FY 2013": "229467298", "FY 2014": "212979990", "FY 2015": "173523891", "FY 2016": "183400922", "FY 2017": "177343613", "FY 2018": "258055760", "FY 2019": "224837318"}}}

function removeDuplicates(arr){
    let unique_array = []
    for(let i = 0;i < arr.length; i++){
        if(unique_array.indexOf(arr[i]) == -1){
            unique_array.push(arr[i])
        }
    }
    return unique_array
}

function makeLink(source, target, value) {

    value = Number.parseInt(value);
    value = value ? value : 0;
    if (value && value != 0) {
        if (value < 0) {
            temp = source;
            source = target;
            target = temp;
        }
        return {
            "source": source,
            "target": target,
            "value": Math.abs(value)
        }
    }
    return {
        "source": source,
        "target": target,
        "value": null
    };
}

let gf_revenues = "General Fund: Revenues";
let gf_expenditures = "General Fund: Expenditures";

let rf_revenues = "Restricted Fund: Revenues";
let rf_expenditures = "Restricted Funds: Expenditures";

function get_data(year) {

    let links = [];
    let nodes = [];

    nodes.push("General Fund");
    Object.keys(budget_data[gf_expenditures]).forEach(function(e) {
        if (e.toLowerCase().indexOf("total") == -1 && e.toLowerCase().indexOf("net expenditures") == -1) {
            nodes.push(e);
            links.push(makeLink("General Funds", e, budget_data[gf_expenditures][e][year]));
        }
    });

    Object.keys(budget_data[gf_revenues]).forEach(function(e) {
        if (e.toLowerCase().indexOf("total") == -1 && e.toLowerCase().indexOf("net expenditures") == -1) {
            nodes.push(e);
            links.push(makeLink(e, "General Funds", budget_data[gf_revenues][e][year]));
        }
    });

    nodes.push("Restricted Funds");
    Object.keys(budget_data[rf_expenditures]).forEach(function(e) {
        if (e.toLowerCase().indexOf("total") == -1 && e.toLowerCase().indexOf("net expenditures") == -1) {
            nodes.push(e);
            links.push(makeLink("Restricted Funds", e, budget_data[rf_expenditures][e][year]));
        }
    });

    Object.keys(budget_data[rf_revenues]).forEach(function(e) {
        if (e.toLowerCase().indexOf("total") == -1 && e.toLowerCase().indexOf("net expenditures") == -1) {
            let value = 0;
            if (Object.keys(budget_data[rf_revenues][e]).indexOf(year) == -1) {
                value = budget_data[rf_revenues][e]["Subtotal"][year]
            } else {
                value = budget_data[rf_revenues][e][year]
            }
            nodes.push(e);
            links.push(makeLink(e, "Restricted Funds", value));
        }
    });

    nodes = removeDuplicates(nodes);

    let filteredLinks = [];
    let filteredNodes = [];

    for (let i = 0; i < links.length; i++) {
        if (links[i].value != null) {
            filteredLinks.push(links[i]);
            let nodeName = [links[i].target, links[i].source].filter((x) => {
                return ["General Funds", "Restricted Funds"].indexOf(x) == -1;
            })[0];
            filteredNodes.push(nodeName);
        }
    }
    filteredNodes = removeDuplicates(filteredNodes);
    filteredNodes.push("General Funds");
    filteredNodes.push("Restricted Funds");
    filteredNodes = filteredNodes.map((x) => {return {"name": x}});

    return {
        "links": filteredLinks,
        "nodes": filteredNodes
    }

}
